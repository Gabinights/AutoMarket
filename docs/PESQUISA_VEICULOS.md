# ?? IMPLEMENTAÇÃO - Sistema de Pesquisa de Veículos

## ? O que foi criado

### **1. Controller - VeiculosController.cs**
```
Controllers/VeiculosController.cs (NOVO)
```

**Funcionalidades:**
- ? Action `Pesquisa()` com suporte a múltiplos filtros
- ? Filtros dinâmicos: Marca, Modelo, Cor, Combustível, Ano, Categoria
- ? Filtros de range: Preço (mín-máx), KM (mín-máx)
- ? 7 opções de ordenação (recente, preço asc/desc, km asc/desc, ano asc/desc)
- ? Query otimizada com EF Core (filtros no SQL)
- ? Carregamento dinâmico de opções do catálogo

### **2. View - Pesquisa.cshtml**
```
Views/Veiculos/Pesquisa.cshtml (NOVO)
```

**Layout:**
- ? **Sidebar Esquerda (280px):** Filtros avançados
- ? **Seção Principal:** Grid responsivo de anúncios
- ? **Header:** Mantido intacto
- ? **Footer:** Mantido intacto

**Componentes:**

#### **Filtros Sidebar:**
| Filtro | Tipo | Características |
|---|---|---|
| Marca | Combobox | Carregado dinamicamente |
| Modelo | Combobox | Carregado dinamicamente |
| Cor | Combobox | Carregado dinamicamente |
| Combustível | Combobox | Carregado dinamicamente |
| Ano | Combobox | Carregado dinamicamente |
| Tipo/Segmento | Combobox | Carregado dinamicamente |
| Preço | 2 Inputs | Mín e Máx (decimal) |
| Quilómetros | 2 Inputs | Mín e Máx (inteiro) |
| Botões | 2 Botões | Pesquisar + Limpar |

#### **Painel de Anúncios:**
- Seletor de ordenação (dropdown)
- Grid responsivo (3 colunas em desktop, 2 em tablet, 1 em mobile)
- Cards com:
  - Imagem do veículo (ou placeholder)
  - Marca + Modelo
  - Preço em destaque (laranja)
  - Ano, Quilómetros, Combustível
  - Categoria
  - Botão "Ver Detalhes"

### **3. CSS - pesquisa.css**
```
wwwroot/css/pesquisa.css (NOVO)
```

**Responsive Design:**
- ? Desktop: Sidebar + Anúncios lado a lado
- ? Tablet (max-width: 1024px): Layout em coluna
- ? Mobile (max-width: 768px): Otimizado para telas pequenas

### **4. Header Atualizado**
```
Views/Shared/_Header.cshtml (MODIFICADO)
```

- ? Botão "Veículos" agora leva a `/Veiculos/Pesquisa`

---

## ?? URLs e Rotas

| URL | Método | Ação | Parâmetros |
|---|---|---|---|
| `/Veiculos/Pesquisa` | GET | Exibir pesquisa | Filtros opcionais |
| `/Veiculos/Pesquisa?marca=BMW` | GET | Pesquisar por marca | Query string |
| `/Veiculos/Pesquisa?precoMin=10000&precoMax=30000` | GET | Filtrar por preço | Query string |
| `/Veiculos/Pesquisa?ordenacao=preco_desc` | GET | Ordenar | recente, preco_asc, preco_desc, km_asc, km_desc, ano_asc, ano_desc |

---

## ?? Filtros Disponíveis

### **Dropdowns (Carregados Dinamicamente)**
```
- Marca: Todas as marcas do catálogo
- Modelo: Todos os modelos
- Cor: Todas as cores
- Combustível: Gasolina, Gasóleo, Híbrido, Elétrico, etc
- Ano: Anos disponíveis (descendente)
- Tipo/Segmento: SUV, Sedan, Hatchback, etc
```

### **Campos Numéricos (Mín-Máx)**
```
- Preço: De 0 a 999999.99 €
- Quilómetros: De 0 a ? km
```

### **Opções de Ordenação**
```
1. Mais recente (padrão)
2. Preço ascendente (maior para menor)
3. Preço descendente (menor para maior)
4. KM ascendentes (menor para maior)
5. KM descendentes (maior para menor)
6. Ano ascendente (menor para maior)
7. Ano descendente (maior para menor)
```

---

## ?? Fluxo de Funcionamento

```
1. Utilizador clica em "Veículos" no header
   ?
2. Redireciona para /Veiculos/Pesquisa
   ?
3. VeiculosController.Pesquisa() carrega filtros do DB
   ?
4. View exibe:
   - Filtros vazios (padrão = mostra todos os ativos)
   - Todos os veículos ativos ordenados por recente
   ?
5. Utilizador preenche filtros (ex: Marca=BMW, Preço=10000-30000)
   ?
6. Clica "Pesquisar"
   ?
7. Form POST ? Query string na URL
   ?
8. Controller filtra dados no SQL
   ?
9. View exibe apenas os veículos que correspondem aos critérios
```

---

## ?? Design e Responsividade

### **Desktop (> 1024px)**
```
???????????????????????????????????????????????????????
? HEADER                                              ?
???????????????????????????????????????????????????????
?   FILTROS        ?    ANÚNCIOS (Grid 3 colunas)     ?
?   Sidebar        ?                                  ?
?   (280px)        ?  [Card] [Card] [Card]            ?
?                  ?  [Card] [Card] [Card]            ?
?                  ?  [Card] [Card] [Card]            ?
???????????????????????????????????????????????????????
? FOOTER                                              ?
???????????????????????????????????????????????????????
```

### **Tablet (768px - 1024px)**
```
???????????????????????????????????????????????????????
? HEADER                                              ?
???????????????????????????????????????????????????????
?   FILTROS (coluna)                                  ?
???????????????????????????????????????????????????????
?    ANÚNCIOS (Grid 2 colunas)                        ?
?  [Card]  [Card]                                     ?
?  [Card]  [Card]                                     ?
???????????????????????????????????????????????????????
? FOOTER                                              ?
???????????????????????????????????????????????????????
```

### **Mobile (< 768px)**
```
???????????????????????????????????????????????????????
? HEADER                                              ?
???????????????????????????????????????????????????????
?   FILTROS (coluna cheia)                            ?
???????????????????????????????????????????????????????
?    ANÚNCIOS (Grid 1 coluna)                         ?
?  [Card]                                             ?
?  [Card]                                             ?
?  [Card]                                             ?
???????????????????????????????????????????????????????
? FOOTER                                              ?
???????????????????????????????????????????????????????
```

---

## ?? Ficheiros Criados/Modificados

### **Criados:**
- ? `Controllers/VeiculosController.cs`
- ? `Views/Veiculos/Pesquisa.cshtml`
- ? `wwwroot/css/pesquisa.css`

### **Modificados:**
- ? `Views/Shared/_Header.cshtml` (botão "Veículos" ? `/Veiculos/Pesquisa`)

---

## ?? Como Testar

1. **Compilar:**
   ```bash
   dotnet build
   ```

2. **Executar:**
   ```bash
   dotnet run
   ```

3. **Aceder:**
   ```
   https://localhost:7000/Veiculos/Pesquisa
   ```

4. **Testar Filtros:**
   - Selecionar marca "BMW" ? Ver apenas BMWs
   - Introduzir preço mín: 20000, máx: 50000 ? Filtrar por preço
   - Mudar ordenação ? Veículos reordenam

---

## ?? Detalhes Técnicos

### **Performance:**
- ? Filtros aplicados no SQL (não em memória)
- ? Apenas veículos `Estado = Ativo` são listados
- ? Carregamento lazy de opções de filtros

### **Segurança:**
- ? Sem risco de SQL injection (EF Core)
- ? Validação de tipos (int, decimal)
- ? Apenas veículos públicos exibidos

### **UX:**
- ? Botão "Limpar" reseta todos os filtros
- ? Ordenação muda sem recarregar página (AJAX)
- ? Valores de filtros mantidos após pesquisa
- ? Mensagem quando nenhum resultado encontrado

---

## ?? Próximas Melhorias (Sugestões)

1. **Paginação** - Dividir resultados em páginas
2. **Busca por texto** - Search bar para marca/modelo
3. **Favoritos** - Guardar carros preferidos
4. **Comparar** - Comparar 2-3 veículos lado a lado
5. **Imagens múltiplas** - Carroussel de fotos
6. **Filtros avançados** - Potência, cilindrada, etc

---

## ? Status

```
? Implementação Completa
? Compilação OK
? Layout Responsivo
? Filtros Funcionais
? Ordenação OK
? Pronto para usar
```

**Agora tens uma página de pesquisa profissional com filtros avançados! ??**
